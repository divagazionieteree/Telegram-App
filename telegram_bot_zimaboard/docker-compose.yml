services:
  telegram-qrcode-bot:
    build:
      context: .
      dockerfile: Dockerfile
      # Configura DNS anche durante il build usando la rete dell'host
      network: host
      # Alternativa: passa DNS come build args (commentato - usa network: host)
      # args:
      #   - BUILDKIT_INLINE_CACHE=1
    container_name: telegram-qrcode-bot
    restart: unless-stopped
    dns:
      - 8.8.8.8
      - 8.8.4.4
      - 1.1.1.1
    environment:
      # IMPORTANTE: Sostituisci con il tuo token Telegram (prendilo da @BotFather)
      - TELEGRAM_BOT_TOKEN=${TELEGRAM_BOT_TOKEN}
      # IMPORTANTE: Sostituisci con il/i tuo/i ID Telegram (separati da virgola se più di uno)
      # Lascia vuoto per disabilitare il controllo di accesso
      - TELEGRAM_ALLOWED_IDS=${TELEGRAM_ALLOWED_IDS}
    volumes:
      # Volume per i dati del portafoglio investimenti (opzionale, solo per modalità investimenti)
      # Crea il file portafoglio_data.json nella directory ./data
      - ./data:/app/data:ro
      # Volume opzionale per logging
      # - ./logs:/app/logs
    # Healthcheck opzionale
    healthcheck:
      test: ["CMD-SHELL", "pgrep -f telegram_bot.py || exit 1"]
      interval: 30s
      timeout: 10s
      retries: 3
      start_period: 40s

